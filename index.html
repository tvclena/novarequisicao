<script>
async function enviar() {
  const produtoId = document.getElementById("produto").value;

  const payload = {
    dataRegistro: "2026-01-12",
    dataTransferencia: "2026-01-12",
    tipo: "TRANSFERENCIA",
    modelo: "DIRETA",
    lojaId: 1,
    localOrigemId: 1,
    localDestinoId: 11,
    solicitanteId: 130,
    motivoRequisicaoId: 1,
    observacaoGeral: "Transferência via API",
    itens: [
      {
        produtoId: Number(produtoId),
        quantidadeTransferida: 1,
        custoMedio: 0,
        custo: 0,
        custoReposicao: 0,
        custoFiscal: 0
      }
    ]
  };

  const res = await fetch("/api/requisicao", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  const text = await res.text();

  if (!text.startsWith("{")) {
    alert("Erro não JSON:\n" + text);
    return;
  }

  alert(JSON.stringify(JSON.parse(text), null, 2));
}
</script>
